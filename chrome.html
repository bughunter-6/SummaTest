<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PoC: chrome:// URL Handling (Risk & Non-Risk)</title>
<style>
  :root { --bg:#0b1220; --card:#121a2b; --muted:#7f8ca3; --accent:#7aa2ff; --good:#30d158; --bad:#ff453a; --warn:#ffd60a; }
  body { background:var(--bg); color:#e6e9ef; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; margin:0; }
  header { padding:20px 24px; border-bottom:1px solid #223; position:sticky; top:0; background:linear-gradient(180deg, rgba(11,18,32,.95), rgba(11,18,32,.8)); backdrop-filter: blur(6px); }
  h1 { margin:0 0 6px; font-size:20px; }
  p { margin:6px 0; color:var(--muted); }
  main { display:grid; grid-template-columns: 1.2fr .8fr; gap:16px; padding:16px; }
  .panel { background:var(--card); border:1px solid #223; border-radius:14px; padding:12px; }
  .controls { display:flex; flex-wrap:wrap; gap:12px; align-items:center; }
  .controls label { display:flex; align-items:center; gap:8px; font-size:14px; color:var(--muted); }
  .badge { padding:2px 8px; border-radius:999px; font-size:12px; border:1px solid #334; }
  .risk-high { background: rgba(255,69,58,.1); color:#ffd1cf; border-color:#532; }
  .risk-dos { background: rgba(255,214,10,.1); color:#fff2cc; border-color:#553; }
  .risk-low { background: rgba(48,209,88,.1); color:#d4ffe2; border-color:#354; }
  table { width:100%; border-collapse:separate; border-spacing:0 8px; }
  th, td { text-align:left; padding:10px 8px; font-size:14px; }
  thead th { color:#aab4c3; font-weight:600; border-bottom:1px solid #223; }
  tr { background:#0f1728; border:1px solid #223; }
  tr td:first-child { border-top-left-radius:10px; border-bottom-left-radius:10px; }
  tr td:last-child { border-top-right-radius:10px; border-bottom-right-radius:10px; }
  .row-actions { display:flex; gap:6px; flex-wrap:wrap; }
  button { background:#16213a; color:#dbe4ff; border:1px solid #2a3557; padding:6px 10px; border-radius:10px; cursor:pointer; font-size:13px; }
  button:hover { border-color:#3d4c7a; }
  .btn-danger { border-color:#5a2a2a; }
  .url { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; color:#c8d4ff; }
  #log { height:320px; overflow:auto; background:#0a0f1c; border:1px solid #223; border-radius:10px; padding:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; }
  .log-line { margin:0 0 6px; }
  .ok { color:var(--good); }
  .warn { color:var(--warn); }
  .err { color:var(--bad); }
  iframe { width:100%; height:240px; background:#0e1424; border:1px dashed #223; border-radius:8px; }
  .note { font-size:12px; color:#9aa5b5; }
  footer { padding:12px 16px; color:#7f8ca3; }
</style>
</head>
<body>
<header>
  <h1>PoC — Handling of <code>chrome://</code> URLs</h1>
  <p>Use this page to test how your browser handles privileged internal URLs across categories. Many attempts will be blocked (expected).
     <strong>DoS links are disabled by default</strong> to avoid accidental crashes — enable them explicitly if needed.</p>
  <div class="controls">
    <label><input type="checkbox" id="enableDos"> Enable DoS/Stability test actions (may hang or crash a tab)</label>
    <label><input type="checkbox" id="navInSameTab"> Use same-tab navigation for "Navigate" (otherwise opens a new tab)</label>
    <span class="badge risk-high">High Risk</span>
    <span class="badge risk-dos">DoS/Stability</span>
    <span class="badge risk-low">Debug/Low Risk</span>
  </div>
</header>

<main>
  <section class="panel">
    <h2 style="margin:0 0 10px;">Test Matrix</h2>
    <div class="note">Actions: <strong>Open</strong> = <code>window.open(url)</code>, <strong>Navigate</strong> = change top location, <strong>iFrame</strong> = set <code>src</code> on the test frame.</div>
    <table id="urlsTable">
      <thead>
        <tr>
          <th>URL</th>
          <th>Category</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <aside class="panel">
    <h3 style="margin:0 0 8px;">Result Log</h3>
    <div id="log" aria-live="polite"></div>
    <h3 style="margin:10px 0 8px;">iFrame Viewer</h3>
    <iframe id="testFrame" title="iFrame target" sandbox=""></iframe>
    <div class="note">The iframe is fully sandboxed. Many internal pages cannot load in iframes by design.</div>
  </aside>
</main>

<footer class="note">
  Tip: Test on different platforms (Desktop, Android, iOS). Differences may indicate platform-specific policy gaps.
</footer>

<script>
const urls = [
  // High Risk / Sensitive
  {url:'chrome://flags', cat:'High Risk'},
  {url:'chrome://policy', cat:'High Risk'},
  {url:'chrome://extensions', cat:'High Risk'},
  {url:'chrome://settings', cat:'High Risk'},
  {url:'chrome://sync-internals', cat:'High Risk'},
  {url:'chrome://password-manager-internals', cat:'High Risk'},
  {url:'chrome://system', cat:'High Risk'},
  {url:'chrome://net-internals', cat:'High Risk'},
  {url:'chrome://histograms', cat:'High Risk'},
  {url:'chrome://gpu', cat:'High Risk'},
  {url:'chrome://crashes', cat:'High Risk'},

  // DoS / Stability
  {url:'chrome://crash', cat:'DoS'},
  {url:'chrome://kill', cat:'DoS'},
  {url:'chrome://hang', cat:'DoS'},
  {url:'chrome://shorthang', cat:'DoS'},
  {url:'chrome://quit', cat:'DoS'},
  {url:'chrome://restart', cat:'DoS'},

  // Debug / Low Risk
  {url:'chrome://version', cat:'Low Risk'},
  {url:'chrome://downloads', cat:'Low Risk'},
  {url:'chrome://history', cat:'Low Risk'},
  {url:'chrome://bookmarks', cat:'Low Risk'},
  {url:'chrome://dino', cat:'Low Risk'}
];

const log = (msg, cls='') => {
  const el = document.createElement('div');
  el.className = 'log-line ' + cls;
  const time = new Date().toLocaleTimeString();
  el.textContent = `[${time}] ${msg}`;
  document.getElementById('log').prepend(el);
};

function addRow(entry) {
  const tbody = document.querySelector('#urlsTable tbody');
  const tr = document.createElement('tr');

  const tdUrl = document.createElement('td');
  tdUrl.innerHTML = `<span class="url">${entry.url}</span>`;
  tr.appendChild(tdUrl);

  const tdCat = document.createElement('td');
  const badgeClass = entry.cat === 'High Risk' ? 'risk-high' : (entry.cat === 'DoS' ? 'risk-dos' : 'risk-low');
  tdCat.innerHTML = `<span class="badge ${badgeClass}">${entry.cat}</span>`;
  tr.appendChild(tdCat);

  const tdActions = document.createElement('td');
  const actions = document.createElement('div');
  actions.className = 'row-actions';

  // window.open
  const btnOpen = document.createElement('button');
  btnOpen.textContent = 'Open';
  btnOpen.onclick = () => {
    try {
      const w = window.open(entry.url, '_blank', 'noopener,noreferrer');
      if (w) {
        log(`window.open attempted -> ${entry.url}`, 'ok');
      } else {
        log(`window.open blocked or failed -> ${entry.url}`, 'warn');
      }
    } catch (e) {
      log(`window.open error for ${entry.url}: ${e}`, 'err');
    }
  };
  actions.appendChild(btnOpen);

  // Navigate
  const btnNav = document.createElement('button');
  btnNav.textContent = 'Navigate';
  btnNav.onclick = () => {
    try {
      const sameTab = document.getElementById('navInSameTab').checked;
      if (sameTab) {
        log(`Attempting same-tab navigation -> ${entry.url}`, 'warn');
        window.location.href = entry.url;
      } else {
        const a = document.createElement('a');
        a.href = entry.url;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        document.body.appendChild(a);
        a.click();
        a.remove();
        log(`Opened in new tab via anchor -> ${entry.url}`, 'ok');
      }
    } catch (e) {
      log(`Navigation error for ${entry.url}: ${e}`, 'err');
    }
  };
  actions.appendChild(btnNav);

  // iFrame
  const btnIframe = document.createElement('button');
  btnIframe.textContent = 'iFrame';
  btnIframe.onclick = () => {
    try {
      const frame = document.getElementById('testFrame');
      frame.src = 'about:blank'; // reset
      setTimeout(() => {
        frame.src = entry.url;
        log(`Set iframe src -> ${entry.url} (likely blocked)`, 'warn');
      }, 50);
    } catch (e) {
      log(`iFrame set error for ${entry.url}: ${e}`, 'err');
    }
  };
  actions.appendChild(btnIframe);

  // Guard dangerous DoS actions
  if (entry.cat === 'DoS') {
    btnOpen.classList.add('btn-danger');
    btnNav.classList.add('btn-danger');
    btnIframe.classList.add('btn-danger');
    const toggle = document.getElementById('enableDos');
    const setDisabled = () => {
      const en = toggle.checked;
      btnOpen.disabled = !en;
      btnNav.disabled = !en;
      btnIframe.disabled = !en;
    };
    setDisabled();
    toggle.addEventListener('change', setDisabled);
  }

  tdActions.appendChild(actions);
  tr.appendChild(tdActions);
  tbody.appendChild(tr);
}

urls.forEach(addRow);

// Log basic environment
log('PoC loaded. Use buttons to test handling of chrome:// URLs.');
log('Note: Many actions will be blocked by design. Differences across platforms/browsers may indicate policy gaps.', 'warn');
</script>
</body>
</html>
